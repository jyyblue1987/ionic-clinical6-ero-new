{"version":3,"sources":["../src/@ionic-clinical6/core/pages/pdf-view/pdf-view.ts"],"names":[],"mappings":"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","file":"pdf-view.js","sourcesContent":["import { Component } from '@angular/core';\nimport { NavController, NavParams } from 'ionic-angular';\nimport { PdfViewerComponent } from 'ng2-pdf-viewer';\nimport { Gesture, Platform } from 'ionic-angular';\n\nimport { ViewChild, ElementRef , Renderer} from '@angular/core';\nimport { ThemeableBrowser, ThemeableBrowserObject, ThemeableBrowserOptions } from '@ionic-native/themeable-browser';\nimport { AppConfig } from '../../config/app.config';\nimport { TranslatorService } from '../../translator/translator.service';\n\n@Component({\n  selector: 'pdf-view',\n  templateUrl: './pdf-view.html'\n})\n\nexport class PdfViewPage {\n  title: string;\n  pdfPath: string;\n  themeColor: string;\n  zoomLevel: number = 1;\n  lastZoomLevel: number = 1;\n  loadingSpinner: boolean = true;\n  velocity: number = 20;\n\n  @ViewChild('eventsContainer') elementParent;\n  @ViewChild('scalingElement') elementChild;\n\n  gesture: Gesture;\n  container = null;\n  viewer = null;\n  transforms = [];\n  initialScale = 0.1265;\n  previousScale = 1;\n  adjustDeltaX = 0;\n  adjustDeltaY = 0;\n  offsetX: number;\n  offsetY: number;\n  pixelDensity: number;\n\n  currentScale = null;\n  currentZoom = 1;\n  currentDeltaX = null;\n  currentDeltaY = null;\n\n  browser: ThemeableBrowserObject;\n  enableAndroidViewer: boolean = false;\n\n  constructor(\n    public translator: TranslatorService,\n    public appConfig: AppConfig,\n    public nav: NavController,\n    public navParams: NavParams,\n    public renderer: Renderer,\n    public platform: Platform\n    ) {\n    this.title = navParams.get('title');\n    this.pdfPath = navParams.get('filePath');\n    this.themeColor = navParams.get('themeColor') || '';\n  }\n\n  ionViewDidLoad() {\n    this.displayPDF();\n  }\n\n  displayPDF() {\n    if (this.platform.is('android')) {\n      this.enableAndroidViewer = true;\n    // These are used to zoom/pan in android \n    // this.container = this.elementParent.nativeElement;\n    // this.viewer = this.elementChild.element.nativeElement;\n    // this.viewer.style.transform = 'scale(' + this.previousScale + ')';\n    // this.init();\n    }\n    else {\n\n      var color = this.themeColor[0] === '#' ? this.themeColor : this.rgb2hex(this.themeColor);\n      var optionsiOS: ThemeableBrowserOptions = {\n        statusbar: {\n          color: color\n          //  color: '#4f2683'\n        },\n        toolbar: {\n          height: 44,\n          color: color\n          //  color: '#4f2683'\n        },\n        title: {\n          color: '#ffffffff',\n          staticText: this.title\n        },\n        backButton: {\n          wwwImage: 'assets/images/back_arrow100x100+15.png',\n          wwwImageDensity: 4,\n          align: 'left',\n          event: 'backPressed'\n        },\n        closeButton: {\n          image: 'close',\n          imagePressed: 'close_pressed',\n          align: 'left',\n          event: 'closePressed'\n        },\n        backButtonCanClose: true\n      };\n\n     this.browser = (new ThemeableBrowser()).create(this.pdfPath, '_blank', optionsiOS);\n     this.browser.on('loadstart').subscribe(\n        res => this.loadStart(res, this),\n       error => this.error(error, 'InAppBrowser loadstart Event Error: ' + error)\n     );\n     this.browser.on('loadstop').subscribe(\n       res => this.loadStop(res),\n       error => this.error(error, 'InAppBrowser loadstop Event Error: ' + error)\n     );\n     this.browser.on('loaderror').subscribe(\n       res => this.loadError(res),\n       error => this.error(error, 'InAppBrowser loaderror Event Error: ' + error)\n     );\n     this.browser.on('exit').subscribe(\n       res => this.exit(res, this),\n       error => this.error(error, 'InAppBrowser exit Event Error: ' + error)\n     );\n\n    }\n  }\n\n\n  rgb2hex(rgb: any) {\n    rgb = rgb.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n    return (rgb && rgb.length === 4) ? '#' +\n    ('0' + parseInt(rgb[1], 10).toString(16)).slice(-2) +\n    ('0' + parseInt(rgb[2], 10).toString(16)).slice(-2) +\n    ('0' + parseInt(rgb[3], 10).toString(16)).slice(-2) : '';\n  }\n  loadStart(resource: any, ref: any) {\n    console.log('pdfView: loadStart.');\n  }\n\n  loadStop(resource: any) {\n    console.log('pdfView: loadStop.');\n  }\n\n  loadError(resource: any) {\n    console.log('pdfView: loadStop.');\n  }\n\n  exit(resource: any, ref: any) {\n    console.log('pdfView: exit Event ' + resource);\n    this.goBack();\n  }\n\n  error(error: any, logMsg: string) {\n    console.error('pdfView: Error  ' + error);\n  }\n\n  goBack() {\n    this.nav.pop(AppConfig.animationOptBack);\n  }\n\n  // loadComplete(ev) {\n  loadComplete() {\n    this.loadingSpinner = false;\n    console.log('loadComplete:' );\n  }\n\n  init = () => {\n  // this.gesture = new Gesture(this.container);\n  // this.gesture.listen();\n  // this.viewer.style.transform = 'scale(' + this.initialScale + ')';\n\n  // this.gesture.on('doubletap', (ev) => {\n  //   // this.transforms = [];\n  //   // this.previousScale += 1;\n  //   // if (this.previousScale >= 4) this.previousScale = 1;\n  //   // this.transforms.push('scale(' + this.previousScale + ')');\n  //   // this.container.style.transform = this.transforms.join(' ');\n  // });\n\n  // this.gesture.on('pinch', (ev) => {\n  //   this.doZoom(ev);\n  // });\n\n  // this.gesture.on('pinchend', (ev) => {\n  //   this.gestureEnd(ev);\n  // });\n\n  // this.gesture.on('panend', (ev) => {\n\n  //   // // Saving the final transforms for adjustment next time the user interacts.\n  //   // this.previousScale = this.currentScale;\n  //   // this.adjustDeltaX = this.currentDeltaX;\n  //   // this.adjustDeltaY = this.currentDeltaY;\n  //   console.log('panend: previousScale:' + this.previousScale);\n  // });\n  }\n\n\n  doZoom(ev: any) {\n      // console.log('pinch: previousScale:' + this.previousScale, ev );\n\n      // this.transforms = [];\n\n      // // Initialize zoom settings in case it's needed\n      // if (this.offsetY === undefined) {\n      //   this.offsetY = this.container.getBoundingClientRect().top;\n      //   this.offsetX = 0;\n      //   console.log('offset: X: ' + this.offsetX + ', Y:' + this.offsetY );\n      // }\n      // if (this.pixelDensity === undefined) {\n      //   this.pixelDensity = this.viewer.clientWidth / this.container.clientWidth;\n      //   console.log('pixelDensity:' + this.pixelDensity );\n      // }\n\n      // // Adjusting the current pinch/pan event properties using the previous ones set when they finished touching\n      // this.currentScale = Math.min (this.previousScale * ev.scale, 6);\n\n      // this.currentDeltaX = (ev.center.x - this.offsetX) / this.container.clientWidth * (this.currentScale - 1) / this.currentScale * this.viewer.clientWidth;\n      // this.currentDeltaY = (ev.center.y - this.offsetY) / this.container.clientHeight * (this.currentScale - 1) / this.currentScale * this.viewer.clientHeight;\n\n      // // In case zoomed image is too small, set it to fit the screen (width)\n      // // this assume this.initialScale is such that it fits screen's width \n      // if (this.currentScale < 1) {\n      //   this.currentScale = 1;\n      //   this.currentDeltaX = this.currentDeltaY = 0;\n      // }\n\n      // this.transforms.push('scale(' + this.currentScale * this.initialScale + ')');\n      // this.container.scrollTop = this.currentDeltaY / this.pixelDensity * this.currentScale;\n      // this.container.scrollLeft = this.currentDeltaX / this.pixelDensity * this.currentScale;\n\n      // // this.transforms.push('translate(' + (- this.currentDeltaX)  + 'px,' + ( - this.currentDeltaY) + 'px)');\n      // // this.viewer.style.transform = this.transforms.join(' ');\n      // this.viewer.style.transform = this.transforms.join(' ');\n\n      // console.log('pinch: currentScale:' + this.currentScale + ', deltaX: ' + (- this.currentDeltaX) + ', deltaY: ' + ( - this.currentDeltaY)\n      //             + ', scrollTop: ' + (- this.container.scrollTop) + ', scrollLeft: ' + ( - this.currentDeltaX / this.pixelDensity), ev);\n\n      // if (ev.isFinal) this.gestureEnd(ev);\n\n  }\n\n  gestureEnd(ev: any) {\n      // // Saving the final transforms for adjustment next time the user interacts.\n      // this.transforms = [];\n\n      // this.zoomLevel = this.zoomLevel / this.currentScale;\n\n      // this.currentDeltaX = (ev.center.x - this.offsetX) / this.container.clientWidth * (this.currentScale - 1) / this.currentScale * this.viewer.clientWidth;\n      // this.currentDeltaY = (ev.center.y - this.offsetY) / this.container.clientHeight * (this.currentScale - 1) / this.currentScale * this.viewer.clientHeight;\n\n      // this.previousScale = this.currentScale;\n      // this.adjustDeltaX = this.currentDeltaX;\n      // this.adjustDeltaY = this.currentDeltaY;\n\n      // this.transforms.push('scale(' + this.currentScale * this.initialScale + ')');\n      // this.container.scrollTop = this.currentDeltaY / this.pixelDensity * this.currentScale;\n      // this.container.scrollLeft = this.currentDeltaX / this.pixelDensity * this.currentScale;\n\n      // // this.transforms.push('scale(' + this.currentScale + ')');\n      // // this.transforms.push('translate(' + this.currentDeltaX + 'px,' + this.currentDeltaY + 'px)');\n      // this.viewer.style.transform = this.transforms.join(' ');\n\n      // console.log('pinchend: currentScale:' + this.currentScale + ', deltaX: ' + (- this.currentDeltaX) + ', deltaY: ' + ( - this.currentDeltaY) , ev);\n\n    }\n\n\n} "]}